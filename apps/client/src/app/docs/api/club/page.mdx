# 동아리 데이터 OpenAPI

### 개요

동아리 데이터 OpenAPI는 재학생들이 소속된 동아리 데이터를 간단한 HTTP 요청을 통하여 서비스에 통합할 수 있도록 돕습니다. 해당 REST API를 호출하여 기본적인 동아리 데이터를 획득할 수 있습니다.

### 인증

모든 API 요청은 HTTP 헤더에 API 키를 포함해야 합니다.

```http
X-API-KEY: your-api-key-here
```

API 키는 UUID 형식이며, 만료되거나 유효하지 않은 키를 사용할 경우 `401 Unauthorized` 응답을 받게 됩니다.

### 엔드포인트

```http
GET /v1/clubs
```

### 권한 범위

`CLUB_READ` 권한이 필요합니다.

### 요청 파라미터

| 파라미터                      | 타입       | 필수 여부 | 설명                                                      | 예시           |
| ----------------------------- | ---------- | --------- | --------------------------------------------------------- | -------------- |
| `clubId`                      | `Long`     | 선택      | 동아리 ID                                                 | `1`            |
| `clubName`                    | `String`   | 선택      | 동아리 이름                                               | `SW개발동아리` |
| `clubType`                    | `ClubType` | 선택      | 동아리 종류 (`MAJOR_CLUB`, `JOB_CLUB`, `AUTONOMOUS_CLUB`) | `MAJOR_CLUB`   |
| `page`                        | `Int`      | 선택      | 페이지 번호 (기본값: 0)                                   | `0`            |
| `size`                        | `Int`      | 선택      | 페이지 크기 (기본값: 100)                                 | `100`          |
| `includeLeaderInParticipants` | `Boolean`  | 선택      | 부장을 부원 목록에 포함할지 여부                          | `false`        |

### 응답 형식

응답은 동아리 정보 목록을 포함하며, 각 동아리 객체는 다음 필드를 포함합니다.

| 필드            | 타입            | 설명           | 예시 |
| --------------- | --------------- | -------------- | ---- |
| `totalPages`    | `Integer`       | 전체 페이지 수 | `1`  |
| `totalElements` | `Integer`       | 전체 동아리 수 | `10` |
| `clubs`         | `List<ClubDto>` | 동아리 목록    | -    |

### 동아리 객체 (ClubDto)

각 동아리 객체는 다음 필드를 포함합니다.

| 필드           | 타입                       | 설명                                                      | 예시           |
| -------------- | -------------------------- | --------------------------------------------------------- | -------------- |
| `id`           | `Long`                     | 동아리 ID                                                 | `1`            |
| `name`         | `String`                   | 동아리 이름                                               | `SW개발동아리` |
| `type`         | `ClubType`                 | 동아리 종류 (`MAJOR_CLUB`, `JOB_CLUB`, `AUTONOMOUS_CLUB`) | `MAJOR_CLUB`   |
| `leader`       | `ParticipantInfoDto`       | 동아리 부장 정보                                          | -              |
| `participants` | `List<ParticipantInfoDto>` | 동아리 부원 목록                                          | -              |

### 부원 정보 객체 (ParticipantInfoDto)

동아리 응답에 포함된 부장 및 부원 정보는 다음 필드를 포함합니다.

| 필드            | 타입     | 설명                                       | 예시               |
| --------------- | -------- | ------------------------------------------ | ------------------ |
| `id`            | `Long`   | 학생 ID                                    | `1`                |
| `name`          | `String` | 학생 이름                                  | `홍길동`           |
| `email`         | `String` | 학생 이메일                                | `s24080@gsm.hs.kr` |
| `studentNumber` | `Int`    | 학번                                       | `1201`             |
| `major`         | `Major`  | 학과 (`SW_DEVELOPMENT`, `SMART_IOT`, `AI`) | `SW_DEVELOPMENT`   |
| `sex`           | `Sex`    | 성별 (`MAN`, `WOMAN`)                      | `MAN`              |

### 요청 예시

```bash
curl -X GET "https://api.datagsm.com/v1/clubs?clubType=MAJOR_CLUB&page=0&size=50" \
  -H "X-API-KEY: your-api-key-here"
```

### 응답 예시

```json
{
  "totalPages": 1,
  "totalElements": 1,
  "clubs": [
    {
      "id": 1,
      "name": "SW개발동아리",
      "type": "MAJOR_CLUB",
      "leader": {
        "id": 1,
        "name": "홍길동",
        "email": "s24080@gsm.hs.kr",
        "studentNumber": 1201,
        "major": "SW_DEVELOPMENT",
        "sex": "MAN"
      },
      "participants": [
        {
          "id": 2,
          "name": "김철수",
          "email": "s24081@gsm.hs.kr",
          "studentNumber": 1202,
          "major": "SW_DEVELOPMENT",
          "sex": "MAN"
        }
      ]
    }
  ]
}
```

### 오류 응답

| 상태 코드               | 설명                              |
| ----------------------- | --------------------------------- |
| `401 Unauthorized`      | API 키가 유효하지 않거나 만료됨   |
| `403 Forbidden`         | 필요한 권한 범위가 없음           |
| `429 Too Many Requests` | 단위 시간에 너무 많은 요청량 발생 |
| `400 Bad Request`       | 잘못된 요청 파라미터              |

### 사용 예제

다음은 Node.js Express 환경에서 동아리 데이터를 조회하는 예제입니다.

```javascript
const express = require('express');
const app = express();
const axios = require('axios');

app.get('/clubs/:id', async (req, res) => {
  try {
    const response = await axios.get(`https://api.datagsm.com/v1/clubs`, {
      headers: {
        'X-API-KEY': 'your-api-key-here',
      },
      params: {
        clubId: req.params.id,
      },
    });
    res.json(response.data);
  } catch (error) {
    res.status(error.response?.status || 500).json({ message: error.message });
  }
});

app.listen(3000, () => {
  console.log('Server is running on port 3000');
});
```

위 예제에서는 Express 서버를 설정하고, 특정 동아리 ID로 동아리 데이터를 조회하는 엔드포인트를 구현하였습니다. `axios`를 사용하여 OpenAPI에 요청을 보내고, 응답 데이터를 클라이언트에 반환합니다.
